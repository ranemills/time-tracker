{"version":3,"sources":["../src/scripts/app.js"],"names":["angular","module","controller","recordService","activityService","mainCtrl","$onInit","_","each","activity","addDefinedActivity","showEdit","saveTime","addRecord","recordPendingSave","recordTime","startTime","endTime","duration","diff","getSelectedActivity","note","discardActivity","getRecords","constant","window","service","selectedActivity","definedActivities","setSelectedActivity","getDefinedActivities","push","records","data","component","templateUrl","bindings","controllerAs","activitySelectorCtrl","changeActivity","getActivities","newActivityName","getButtonStyle","addActivity","timePieChartCtrl","labels","chartData","equals","cachedRecords","clone","transform","result","record","get","size","keys","cachedData","values","$scope","timeChartCtrl","options","scales","yAxes","display","ticks","beginAtZero","onStop","moment","isTiming","start","$broadcast","stop","$on","bind","event","onSave","onCancel","editActivityCtrl","activityTypes"],"mappings":"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","file":"app.js","sourcesContent":["angular.module('timeTrackerApp', ['angularMoment', 'timer', 'chart.js'])\n.controller('mainCtrl', function (recordService, activityService) {\n  let mainCtrl = this;\n\n  mainCtrl.$onInit = function() {\n    _.each(['Default', 'PR Review', 'Coding', 'Talking'], (activity) => activityService.addDefinedActivity(activity));\n    mainCtrl.showEdit = false;\n  };\n\n  mainCtrl.saveTime = function() {\n    recordService.addRecord(mainCtrl.recordPendingSave);\n    mainCtrl.showEdit = false;\n    mainCtrl.recordPendingSave = null;\n  };\n\n  mainCtrl.recordTime = function(startTime, endTime) {\n    mainCtrl.showEdit = true;\n    mainCtrl.recordPendingSave = {\n      startTime,\n      endTime,\n      duration: endTime.diff(startTime),\n      activity: activityService.getSelectedActivity(),\n      note: ''\n    }\n  };\n\n  mainCtrl.discardActivity = function() {\n    mainCtrl.showEdit = false;\n    mainCtrl.recordPendingSave = null;\n  };\n\n  mainCtrl.getRecords = recordService.getRecords;\n\n})\n.constant('_', window._)\n.service('activityService', function() {\n\n  let selectedActivity = '';\n  let definedActivities = [];\n\n  function getSelectedActivity() {\n    return selectedActivity;\n  }\n\n  function setSelectedActivity(activity) {\n    selectedActivity = activity;\n  }\n\n  function getDefinedActivities() {\n    return definedActivities;\n  }\n\n  function addDefinedActivity(activity) {\n    definedActivities.push(activity);\n  }\n\n  return {\n    getSelectedActivity,\n    setSelectedActivity,\n    getDefinedActivities,\n    addDefinedActivity\n  }\n})\n.service('recordService', function() {\n\n  // Record format: { startDate, endDate, duration, activity }\n\n  let records = [];\n\n  function getRecords() {\n    return records;\n  }\n\n  function addRecord(data) {\n    records.push(data);\n  }\n\n  return {\n    getRecords,\n    addRecord\n  }\n})\n.component('charts', {\n  templateUrl: 'components/charts.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'chartsCtrl',\n  controller: function() {\n\n  }\n})\n.component('activitySelector', {\n  templateUrl: 'components/activity-selector.html',\n  bindings: {},\n  controllerAs: 'activitySelectorCtrl',\n  controller: function(activityService) {\n    let activitySelectorCtrl = this;\n\n    activitySelectorCtrl.$onInit = function() {\n      activitySelectorCtrl.changeActivity(activitySelectorCtrl.getActivities()[0]);\n      activitySelectorCtrl.newActivityName = '';\n    };\n\n    activitySelectorCtrl.getActivities = activityService.getDefinedActivities;\n\n    activitySelectorCtrl.getButtonStyle  = function(activity) {\n      return activity === activityService.getSelectedActivity() ? 'active' : '';\n    };\n\n    activitySelectorCtrl.changeActivity = function(activity) {\n      activityService.setSelectedActivity(activity);\n    };\n\n    activitySelectorCtrl.addActivity = function() {\n      activityService.addDefinedActivity(activitySelectorCtrl.newActivityName);\n      activityService.setSelectedActivity(activitySelectorCtrl.newActivityName);\n      activitySelectorCtrl.newActivityName = '';\n    }\n  }\n})\n.component('timePieChart', {\n  templateUrl: 'components/time-pie-chart.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'timePieChartCtrl',\n  controller: function() {\n    let timePieChartCtrl = this;\n\n    timePieChartCtrl.$onInit = function() {\n      timePieChartCtrl.labels = ['All'];\n    };\n\n    timePieChartCtrl.chartData = function() {\n      if(!angular.equals(timePieChartCtrl.records, timePieChartCtrl.cachedRecords))\n      {\n        timePieChartCtrl.cachedRecords = _.clone(timePieChartCtrl.records);\n\n        let data = _.transform(timePieChartCtrl.records, function(result, record) {\n          result[record.activity] = _.get(result, record.activity, 0) + record.duration/1000;\n        }, {});\n\n        if(_.size(data) !== 0) {\n          timePieChartCtrl.labels = _.keys(data);\n          timePieChartCtrl.cachedData =  _.values(data);\n        } else {\n          timePieChartCtrl.labels = ['N/A'];\n          timePieChartCtrl.cachedData = [0];\n        }\n      }\n      return timePieChartCtrl.cachedData;\n    }\n  }\n})\n.component('timeChart', {\n  templateUrl: 'components/time-chart.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'timeChartCtrl',\n  controller: function($scope, _) {\n    let timeChartCtrl = this;\n\n    timeChartCtrl.$onInit = function() {\n      timeChartCtrl.labels = ['All'];\n      timeChartCtrl.options = {\n        scales: {\n          yAxes: [{\n            display: true,\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      }\n    };\n\n    timeChartCtrl.chartData = function() {\n      if(!angular.equals(timeChartCtrl.records, timeChartCtrl.cachedRecords))\n      {\n        timeChartCtrl.cachedRecords = _.clone(timeChartCtrl.records);\n\n        let data = _.transform(timeChartCtrl.records, function(result, record) {\n          result[record.activity] = _.get(result, record.activity, 0) + record.duration/1000;\n        }, {});\n\n        if(_.size(data) !== 0) {\n          timeChartCtrl.labels = _.keys(data);\n          timeChartCtrl.cachedData =  _.values(data);\n        } else {\n          timeChartCtrl.labels = ['N/A'];\n          timeChartCtrl.cachedData = [0];\n        }\n      }\n      return timeChartCtrl.cachedData;\n    }\n  }\n})\n.component('recordTable', {\n  templateUrl: 'components/records-table.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'recordTableCtrl',\n  controller: function() {\n    this.getRecords = () => this.records;\n  }\n})\n.component('timerComponent', {\n  templateUrl: 'components/timer.html',\n  bindings: {\n    onStop: '&'\n  },\n  controllerAs: 'timerCtrl',\n  controller: function ($scope, moment) {\n\n    this.$onInit = function() {\n      this.isTiming = false;\n      this.startTime = null;\n      this.endTime = null;\n    };\n\n    this.start = function () {\n      $scope.$broadcast('timer-start');\n      this.startTime = moment();\n      this.isTiming = true;\n    };\n\n    this.stop = function () {\n      $scope.$broadcast('timer-stop');\n    };\n\n    // Once we know that the timer has stopped, we can do stuff with it\n    $scope.$on('timer-stopped', angular.bind(this, function (event, data) {\n      this.endTime = moment();\n      this.isTiming = false;\n      this.onStop({startTime: this.startTime, endTime: this.endTime});\n    }));\n  }\n})\n.component('editActivityComponent', {\n  templateUrl: 'components/edit-activity.html',\n  bindings: {\n    activity: '<',\n    onSave: '&',\n    onCancel: '&'\n  },\n  controllerAs: 'editActivityCtrl',\n  controller: function (activityService) {\n    let editActivityCtrl = this;\n\n    editActivityCtrl.$onInit = function() {\n      editActivityCtrl.activityTypes = activityService.getDefinedActivities();\n    }\n  }\n});"]}