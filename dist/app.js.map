{"version":3,"sources":["../src/scripts/app.js"],"names":["angular","module","run","activityService","recordService","init","$rootScope","$window","testService","testWrapper","fn","params","isTestMode","$apply","_","identity","enableTestMode","addActivity","addRecord","service","testMode","disableTestMode","controller","mainCtrl","$onInit","showEdit","saveTime","recordPendingSave","recordTime","startTime","endTime","duration","diff","activity","getSelectedActivity","note","discardActivity","getRecords","constant","window","storageService","STORAGE_DEFINED_ACTIVITIES","selectedActivity","definedActivities","getValue","setSelectedActivity","getDefinedActivities","addDefinedActivity","push","setValue","STORAGE_RECORDED_ACTIVITIES","records","data","key","localStorage","setItem","JSON","stringify","parse","getItem","clear","component","templateUrl","bindings","controllerAs","activitySelectorCtrl","changeActivity","getActivities","newActivityName","getButtonStyle","timePieChartCtrl","labels","chartData","equals","cachedRecords","clone","transform","result","record","get","size","keys","cachedData","values","$scope","timeChartCtrl","options","scales","yAxes","display","ticks","beginAtZero","onStop","moment","isTiming","start","$broadcast","stop","$on","bind","event","onSave","onCancel","editActivityCtrl","activityTypes","settingsCtrl","location","reload"],"mappings":"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","file":"app.js","sourcesContent":["angular.module('timeTrackerApp', ['angularMoment', 'timer', 'chart.js'])\n.run(function(activityService, recordService) {\n  activityService.init();\n  recordService.init();\n})\n// This run-block defines test-only functionality\n.run(function($rootScope, $window, testService, recordService) {\n  function testWrapper(fn) {\n    return function(params) {\n      if(testService.isTestMode()) {\n        fn(params);\n        $rootScope.$apply();\n      }\n      else {\n        _.identity();\n      }\n    }\n  }\n\n  $window.enableTestMode = testService.enableTestMode;\n  $window.addActivity = testWrapper(recordService.addRecord);\n})\n.service('testService', function () {\n\n  let testMode = false;\n\n  function enableTestMode() {\n    testMode = true;\n  }\n\n  function disableTestMode() {\n    testMode = false;\n  }\n\n  function isTestMode() {\n    return testMode;\n  }\n\n  return {\n    enableTestMode,\n    disableTestMode,\n    isTestMode\n  }\n\n})\n.controller('mainCtrl', function (recordService, activityService) {\n  let mainCtrl = this;\n\n  mainCtrl.$onInit = function() {\n    mainCtrl.showEdit = false;\n  };\n\n  mainCtrl.saveTime = function() {\n    recordService.addRecord(mainCtrl.recordPendingSave);\n    mainCtrl.showEdit = false;\n    mainCtrl.recordPendingSave = null;\n  };\n\n  mainCtrl.recordTime = function(startTime, endTime) {\n    mainCtrl.showEdit = true;\n    mainCtrl.recordPendingSave = {\n      startTime,\n      endTime,\n      duration: endTime.diff(startTime),\n      activity: activityService.getSelectedActivity(),\n      note: ''\n    }\n  };\n\n  mainCtrl.discardActivity = function() {\n    mainCtrl.showEdit = false;\n    mainCtrl.recordPendingSave = null;\n  };\n\n  mainCtrl.getRecords = recordService.getRecords;\n\n})\n.constant('_', window._)\n.service('activityService', function(storageService) {\n  const STORAGE_DEFINED_ACTIVITIES = \"DEFINED_ACTIVITIES\";\n\n  let selectedActivity = '';\n  let definedActivities = [];\n\n  function init() {\n    definedActivities = storageService.getValue(STORAGE_DEFINED_ACTIVITIES) || ['Default'];\n  }\n\n  function getSelectedActivity() {\n    return selectedActivity;\n  }\n\n  function setSelectedActivity(activity) {\n    selectedActivity = activity;\n  }\n\n  function getDefinedActivities() {\n    return definedActivities;\n  }\n\n  function addDefinedActivity(activity) {\n    definedActivities.push(activity);\n    storageService.setValue(STORAGE_DEFINED_ACTIVITIES, definedActivities);\n  }\n\n  return {\n    init,\n    getSelectedActivity,\n    setSelectedActivity,\n    getDefinedActivities,\n    addDefinedActivity\n  }\n})\n.service('recordService', function(storageService) {\n  const STORAGE_RECORDED_ACTIVITIES = \"RECORDED_ACTIVITIES\";\n\n  // Record format: { startDate, endDate, duration, activity }\n\n  let records = [];\n\n  function init() {\n    records = storageService.getValue(STORAGE_RECORDED_ACTIVITIES) || [];\n  }\n\n  function getRecords() {\n    return records;\n  }\n\n  function addRecord(data) {\n    records.push(data);\n    storageService.setValue(STORAGE_RECORDED_ACTIVITIES, records);\n  }\n\n  return {\n    init,\n    getRecords,\n    addRecord\n  }\n})\n.service('storageService', function(_, $window) {\n\n  function setValue(key, data) {\n    $window.localStorage.setItem(key, JSON.stringify(data));\n  }\n\n  function getValue(key) {\n    return JSON.parse($window.localStorage.getItem(key));\n  }\n\n  function clear() {\n    $window.localStorage.clear();\n  }\n\n  return {\n    setValue,\n    getValue,\n    clear\n  }\n\n})\n.component('charts', {\n  templateUrl: 'components/charts.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'chartsCtrl',\n  controller: function() {\n\n  }\n})\n.component('activitySelector', {\n  templateUrl: 'components/activity-selector.html',\n  bindings: {},\n  controllerAs: 'activitySelectorCtrl',\n  controller: function(activityService) {\n    let activitySelectorCtrl = this;\n\n    activitySelectorCtrl.$onInit = function() {\n      activitySelectorCtrl.changeActivity(activitySelectorCtrl.getActivities()[0]);\n      activitySelectorCtrl.newActivityName = '';\n    };\n\n    activitySelectorCtrl.getActivities = activityService.getDefinedActivities;\n\n    activitySelectorCtrl.getButtonStyle  = function(activity) {\n      return activity === activityService.getSelectedActivity() ? 'active' : '';\n    };\n\n    activitySelectorCtrl.changeActivity = function(activity) {\n      activityService.setSelectedActivity(activity);\n    };\n\n    activitySelectorCtrl.addActivity = function() {\n      activityService.addDefinedActivity(activitySelectorCtrl.newActivityName);\n      activityService.setSelectedActivity(activitySelectorCtrl.newActivityName);\n      activitySelectorCtrl.newActivityName = '';\n    }\n  }\n})\n.component('timePieChart', {\n  templateUrl: 'components/time-pie-chart.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'timePieChartCtrl',\n  controller: function() {\n    let timePieChartCtrl = this;\n\n    timePieChartCtrl.$onInit = function() {\n      timePieChartCtrl.labels = ['All'];\n    };\n\n    timePieChartCtrl.chartData = function() {\n      if(!angular.equals(timePieChartCtrl.records, timePieChartCtrl.cachedRecords))\n      {\n        timePieChartCtrl.cachedRecords = _.clone(timePieChartCtrl.records);\n\n        let data = _.transform(timePieChartCtrl.records, function(result, record) {\n          result[record.activity] = _.get(result, record.activity, 0) + record.duration/1000;\n        }, {});\n\n        if(_.size(data) !== 0) {\n          timePieChartCtrl.labels = _.keys(data);\n          timePieChartCtrl.cachedData =  _.values(data);\n        } else {\n          timePieChartCtrl.labels = ['N/A'];\n          timePieChartCtrl.cachedData = [0];\n        }\n      }\n      return timePieChartCtrl.cachedData;\n    }\n  }\n})\n.component('timeChart', {\n  templateUrl: 'components/time-chart.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'timeChartCtrl',\n  controller: function($scope, _) {\n    let timeChartCtrl = this;\n\n    timeChartCtrl.$onInit = function() {\n      timeChartCtrl.labels = ['All'];\n      timeChartCtrl.options = {\n        scales: {\n          yAxes: [{\n            display: true,\n            ticks: {\n              beginAtZero: true\n            }\n          }]\n        }\n      }\n    };\n\n    timeChartCtrl.chartData = function() {\n      if(!angular.equals(timeChartCtrl.records, timeChartCtrl.cachedRecords))\n      {\n        timeChartCtrl.cachedRecords = _.clone(timeChartCtrl.records);\n\n        let data = _.transform(timeChartCtrl.records, function(result, record) {\n          result[record.activity] = _.get(result, record.activity, 0) + record.duration/1000;\n        }, {});\n\n        if(_.size(data) !== 0) {\n          timeChartCtrl.labels = _.keys(data);\n          timeChartCtrl.cachedData =  _.values(data);\n        } else {\n          timeChartCtrl.labels = ['N/A'];\n          timeChartCtrl.cachedData = [0];\n        }\n      }\n      return timeChartCtrl.cachedData;\n    }\n  }\n})\n.component('recordTable', {\n  templateUrl: 'components/records-table.html',\n  bindings: {\n    records: '<'\n  },\n  controllerAs: 'recordTableCtrl',\n  controller: function() {\n    this.getRecords = () => this.records;\n  }\n})\n.component('timerComponent', {\n  templateUrl: 'components/timer.html',\n  bindings: {\n    onStop: '&'\n  },\n  controllerAs: 'timerCtrl',\n  controller: function ($scope, moment) {\n\n    this.$onInit = function() {\n      this.isTiming = false;\n      this.startTime = null;\n      this.endTime = null;\n    };\n\n    this.start = function () {\n      $scope.$broadcast('timer-start');\n      this.startTime = moment();\n      this.isTiming = true;\n    };\n\n    this.stop = function () {\n      $scope.$broadcast('timer-stop');\n    };\n\n    // Once we know that the timer has stopped, we can do stuff with it\n    $scope.$on('timer-stopped', angular.bind(this, function (event, data) {\n      this.endTime = moment();\n      this.isTiming = false;\n      this.onStop({startTime: this.startTime, endTime: this.endTime});\n    }));\n  }\n})\n.component('editActivityComponent', {\n  templateUrl: 'components/edit-activity.html',\n  bindings: {\n    activity: '<',\n    onSave: '&',\n    onCancel: '&'\n  },\n  controllerAs: 'editActivityCtrl',\n  controller: function (activityService) {\n    let editActivityCtrl = this;\n\n    editActivityCtrl.$onInit = function() {\n      editActivityCtrl.activityTypes = activityService.getDefinedActivities();\n    }\n  }\n})\n.component('settingsComponent', {\n  templateUrl: 'components/settings.html',\n  bindings: {},\n  controllerAs: 'settingsCtrl',\n  controller: function ($window, storageService) {\n    let settingsCtrl = this;\n\n    settingsCtrl.clear = function() {\n      storageService.clear();\n      $window.location.reload();\n    }\n  }\n});"]}